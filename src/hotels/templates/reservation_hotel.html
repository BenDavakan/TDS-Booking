{% extends 'base.html'%}
{% load static %}
{% load humanize %}
{% block style %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.17/css/intlTelInput.css" integrity="sha512-gxWow8Mo6q6pLa1XH/CcH8JyiSDEtiwJV78E+D+QP0EVasFs8wKXq16G8CLD4CJ2SnonHr4Lm/yY2fSI2+cbmw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

{% endblock style %}
{% block content %}

<div class="container">
	<div class="row">
		<div class="col-12 mt-3">
			<div class="row col-12 mb-2">
				<h2><a href="{% url 'hotel' hotel.slug %}">{{ hotel.name }}</a> 
				<span style="color: #bbb8b2;">| </span>
				<span style="color: #FFB913;">Chambre {{ chambre.number }}</span>
				</h2>
			</div>
		</div>
	</div>
	<div class="row my-2">
		<div class="col-8">
		    <form method="POST">
				{% csrf_token %}
				<div class="card">
					<h5 class="card-header"> <span class="mr-2"><i class="fa-solid fa-user"></i></span> Étage 1 - Vos Coordonnées</h5>
					<div class="card-body">
						<div class="mb-3">
							<label for="prenoms" class="form-label">Prénoms</label>
							<input type="text" name="first_name" class="form-control" id="prenoms" placeholder="Prénoms" value="{{ request.user.first_name }}" required>
						</div>
						<div class="mb-3">
							<label for="nom" class="form-label">Nom</label>
							<input type="text" name="last_name" class="form-control" id="nom" placeholder="Nom" value="{{ request.user.last_name }}" required>
						</div>
						<div class="mb-3">
							<label for="email" class="form-label">Email</label>
							<input type="email" name="email" class="form-control" id="email" placeholder="Email" value="{{ request.user.email }}" required>
						</div>
						<div class="mb-3">
							<label for="tel" class="form-label">Tel</label>
							<input type="tel" name="tel" class="form-control w-100" id="tel">
						</div>
						{{ request.chambre.name }}
					</div>
				</div>
				<div class="card my-2">
					<h5 class="card-header"> <span class="mr-2"><i class="fa-solid fa-bed"></i></span> Étage 2 - Informations sur la chambre</h5>
					<div class="card-body">
						<h5 class="mb-1">Services et équipements de l’hébergement</h5>
						<p class="rate mb-3">
							<span class="loc"><i class="fa-solid fa-wifi mr-1"></i>Wi-fi graduit</span>
							<span class="loc mx-2"><i class="fa-solid fa-square-parking mr-1"></i>Parking disponible</span>
							<span class="loc "><i class="fa-solid fa-person-swimming mr-1"></i>Piscine</span>
							<span class="loc mx-2"><i class="fa-solid fa-ban-smoking mr-1"></i>Non-fumeurs</span>
						</p>
						<p>
							Lorem ipsum dolor sit amet consectetur adipisicing elit. Amet mollitia dolores commodi velit aliquid magnam, sapiente illum totam deserunt reiciendis provident, architecto officiis, praesentium doloribus unde dolorem. Debitis, dolorem nesciunt?
						</p>
					</div>
				</div>
				<div class="card">
					<h5 class="card-header"> <span class="mr-2"><i class="fa-solid fa-lock"></i></span> Étage 3 - Mode de paiement</h5>
					<div class="card-body">
						<div class="pl-2" style="height:50px; border:rgba(53, 52, 52, 0.137) 1px solid; border-bottom: none; display:flex; align-items: center;">
							<div class="form-check " >
								<input class="form-check-input" type="radio" name="check" value="card" id="flexRadioDefault1" checked>
								<label class="form-check-label" for="flexRadioDefault1"> <span><i class="fa-solid fa-credit-card"></i></span> Carte de paiement </label>
							</div>
						</div>
						<div class="pl-2" style="height:50px; border:rgba(53, 52, 52, 0.137) 1px solid; border-bottom: none; display:flex; align-items: center;">
							<div class="form-check " >
								<input class="form-check-input" type="radio" name="check" value="momo" id="flexRadioDefault1" >
								<label class="form-check-label" for="flexRadioDefault1"> <span><i class="fa-solid fa-credit-card"></i></span> Mobile Money</label>
							</div>
						</div>
						<div class="pl-2" style="height:50px; border:rgb(53, 52, 52, 0.137) 1px solid;  display:flex; align-items: center;">
							<div class="form-check " >
								<input class="form-check-input" type="radio" name="check" value="paypal" id="flexRadioDefault2" >
								<label class="form-check-label" for="flexRadioDefault2"> <span><i class="fa-brands fa-cc-paypal"></i></span> Paypal</label>
							</div>
						</div>
						
					</div>
				</div>
				<div class="card mt-2">
					<h5 class="card-header">Conditions d'Annulation</h5>
					<div class="card-body">
						{% lorem 1 %}
					</div>
				</div>
				<div class="card my-2">
					<div class="card-body">
						
						<hr>
						<h5 class="mb-1">Conditions de réservation</h5>
						<p>
							En cliquant sur « Confirmer et payer maintenant », vous confirmez avoir lu et accepté nos 
							<a href="">conditions d’utilisation </a>, la <a href="#">politique de confidentialité</a> et les <a href="#">conseils aux voyageurs du ministère des Affaires étrangères</a> .
						</p>
						<p>
							<button type="submit" class="btn btn-primary btn-lg">Confirmation</button>
						</p>
					</div>
				</div>
		   </form>
		</div>
		<div class="col-4 ">
			<div class="card p-2" style="width: 100%;">
				<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
					<div class="carousel-inner">
					  <div class="carousel-item active">
						<img class="d-block w-100" src="{% static 'img/bg-img/50.jpg' %}" alt="First slide">
					  </div>
					  <div class="carousel-item">
						<img class="d-block w-100" src="{% static 'img/bg-img/51.jpg' %}" alt="Second slide">
					  </div>
					  <div class="carousel-item">
						<img class="d-block w-100" src="{% static 'img/bg-img/52.jpg' %}" alt="Third slide">
					  </div>
					</div>
					<a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
					  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
					  <span class="sr-only">Previous</span>
					</a>
					<a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next" >
					  <span class="carousel-control-next-icon" aria-hidden="true"></span>
					  <span class="sr-only" >Next</span>
					</a>
				  </div>
				<div class="">
				  <h4 class="">{{ hotel.name }}</h4>
				  <p class="">{{ hotel.adress }}</p>
				  <div class="d-flex">
					<h5 class="">Arrivée :</h5>
					<p class="ml-1 mb-0">{{ date1 }}</p>
				  </div>
				  <div class="d-flex">
					<h5 class="">Départ :</h5>
					<p class="ml-1 mb-0">{{ date2 }}</p>
				  </div>
				  <p class="mt-1 mb-0">Séjour de {{ sejour }} jours</p>
				  <p class="mt-1 mb-0">Nuité : {{ chambre.overnight | intcomma }} F CFA</p>
				</div>
			</div>
			<div class="card my-2">
				<h5 class="card-header " style="background: #fff;"> Details du prix</h5>
				<div class="card-body">
					<div class="d-flex justify-content-between">
						<p>1 chambre x {{ sejour }} nuit</p>						
						<p>{{ amount | intcomma }} F CFA</p>					

					</div>
					
					<div class="d-flex justify-content-between">
						<p>Taxes et frais</p>
						<p>0 F CFA</p>
						
					</div>
					
					<hr>
					
					<div class="d-flex justify-content-between">
						<h4>Total</h4>
						<h4>{{ amount | intcomma}} F CFA</h4>

					</div>
				</div>
			</div>
		</div>
	</div>
</div>


{% endblock %}


{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.17/js/intlTelInput.min.js" integrity="sha512-1NlRc/n6l/Gl7K7u9g6Z9kxZsKqcJV5uWM/Tv/WCjxDBqUSlxlgHgQI4Z17RW7BdNJjgLj0l6x0kGd0DOvu4AQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
	function getIp(callback) {
		fetch('https://ipinfo.io/json?token=9299d29dc5c97f', { headers: { 'Accept': 'application/json' }})
		  .then((resp) => resp.json())
		  .catch(() => {
			return {
			  country: 'bj',
			};
		  })
		  .then((resp) => callback(resp.country));
	   };
	   
	const phoneInputField = document.querySelector("#tel");
	const phoneInput = window.intlTelInput(phoneInputField, {
	  initialCountry: "auto",
      geoIpLookup: getIp,
	  preferredCountries: ["bj"],
	  utilsScript:
		"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
	});

	const info = document.querySelector(".alert-info");
    const error = document.querySelector(".alert-error");

	function process(event) {
	event.preventDefault();

	phoneInput.getNumber();

	const data = new URLSearchParams();
    data.append("phone", phoneNumber);

	fetch("http://tds-tel-input-1990.twil.io/lookup", {
	method: "POST",
	body: data,
	})
	.then((response) => response.json())
	.then((json) => {
		if (json.success) {
		info.style.display = "";
		info.innerHTML = `Phone number in E.164 format: <strong>${phoneNumber}</strong>`;
		} else {
		console.log(json.error);
		error.style.display = "";
		error.innerHTML = `Invalid phone number.`;
		}
	})
	.catch((err) => {
		error.style.display = "";
		error.innerHTML = `Something went wrong: ${err}`;
	});

	}

  </script>
{% endblock  %}
	